!function(){function e(e){return e&&e.__esModule?e.default:e}var t={};var n=function(e){var n=t[e];if(null==n)throw new Error("Could not resolve bundle with id "+e);return n};(function(e){for(var n=Object.keys(e),s=0;s<n.length;s++)t[n[s]]=e[n[s]]})(JSON.parse('{"3SFso":"index.5293237e.js","6Z78t":"quiet.94f4b135.wasm"}'));const s=e=>(new TextEncoder).encode(e);function r(e,t){var n=e.exports.stackAlloc(t.length);return new Int8Array(e.exports.memory.buffer).set(t,n),n}function a(e,t){return r(e,s(t+"\0"))}const i=16384;class c{constructor(e,t){this.destroyed=!1,this.audioContext=e,this.instance=t}selectProfile(e,t){const n=this.instance.exports.stackSave(),s=a(this.instance,JSON.stringify({profile:e})),r=a(this.instance,"profile"),c=this.instance.exports.quiet_encoder_profile_str(s,r);return this.encoder=this.instance.exports.quiet_encoder_create(c,this.audioContext.sampleRate),this.instance.exports.free(c),this.frameLength=t?this.instance.exports.quiet_encoder_clamp_frame_len(this.encoder,i):this.instance.exports.quiet_encoder_get_frame_len(this.encoder),this.samples=function(e,t){const n=t.exports.malloc(4*e);return{pointer:n,view:new Float32Array(t.exports.memory.buffer).subarray(n/4,n/4+e)}}(i,this.instance),this.instance.exports.stackRestore(n),this}async transmit(e){const t=this.instance.exports.stackSave();var n;"suspended"===(n=this.audioContext).state&&n.resume();const s=function(e,t){const n=[];for(let s=0;s<e.byteLength;s+=t){const r=e.slice(s,s+t);n.push(r)}return n}(e,this.frameLength);let a=this.audioContext.currentTime;for(const e of s){const t=this.audioContext.createBuffer(1,i,this.audioContext.sampleRate),n=r(this.instance,new Uint8Array(e));this.instance.exports.quiet_encoder_send(this.encoder,n,e.byteLength);for(let e=this.instance.exports.quiet_encoder_emit(this.encoder,this.samples.pointer,i);e<i;e++)this.samples.view[e]=0;t.copyToChannel(this.samples.view,0,0);const s=new AudioBufferSourceNode(this.audioContext);s.buffer=t,s.connect(this.audioContext.destination),s.start(a),a+=t.duration}var c;return this.instance.exports.stackRestore(t),await(c=a-this.audioContext.currentTime,new Promise((e=>setTimeout(e,1e3*c)))),this}destroy(){return this.destroyed||(this.instance.exports.free(this.samples.pointer),this.instance.exports.quiet_encoder_destroy(this.encoder),this.destroyed=!0),this}}class o{constructor(e,t){this.audioContext=e,this.instance=t}async transmit({payload:e,profile:t,clampFrame:n}){(await new c(this.audioContext,this.instance).selectProfile(t,n).transmit(s(e))).destroy()}}const l={env:{__sys_getpid:()=>null},wasi_snapshot_preview1:{proc_exit:()=>null,clock_time_get:()=>null,fd_close:()=>null,fd_write:()=>null,fd_seek:()=>null,fd_read:()=>null}};var _=e(JSON.parse('{"audible":{"checksum_scheme":"crc32","inner_fec_scheme":"v27","outer_fec_scheme":"none","mod_scheme":"gmsk","frame_length":25,"modulation":{"center_frequency":4200,"gain":0.15},"interpolation":{"shape":"kaiser","samples_per_symbol":10,"symbol_delay":4,"excess_bandwidth":0.35},"encoder_filters":{"dc_filter_alpha":0.01},"resampler":{"delay":13,"bandwidth":0.45,"attenuation":60,"filter_bank_size":64}},"audible-7k-channel-0":{"mod_scheme":"arb16opt","checksum_scheme":"crc32","inner_fec_scheme":"v29","outer_fec_scheme":"rs8","frame_length":600,"modulation":{"center_frequency":9200,"gain":0.01},"interpolation":{"shape":"kaiser","samples_per_symbol":6,"symbol_delay":4,"excess_bandwidth":0.31},"encoder_filters":{"dc_filter_alpha":0.01},"resampler":{"delay":13,"bandwidth":0.45,"attenuation":60,"filter_bank_size":64},"ofdm":{"num_subcarriers":48,"cyclic_prefix_length":8,"taper_length":4,"left_band":0,"right_band":0}},"audible-7k-channel-1":{"mod_scheme":"arb16opt","checksum_scheme":"crc32","inner_fec_scheme":"v29","outer_fec_scheme":"rs8","frame_length":600,"modulation":{"center_frequency":15500,"gain":0.01},"interpolation":{"shape":"kaiser","samples_per_symbol":6,"symbol_delay":4,"excess_bandwidth":0.31},"encoder_filters":{"dc_filter_alpha":0.01},"resampler":{"delay":13,"bandwidth":0.45,"attenuation":60,"filter_bank_size":64},"ofdm":{"num_subcarriers":48,"cyclic_prefix_length":8,"taper_length":4,"left_band":0,"right_band":0}},"cable-64k":{"mod_scheme":"qam1024","checksum_scheme":"crc32","inner_fec_scheme":"v27p23","outer_fec_scheme":"rs8","frame_length":7500,"modulation":{"center_frequency":10200,"gain":0.09},"interpolation":{"shape":"kaiser","samples_per_symbol":2,"symbol_delay":4,"excess_bandwidth":0.35},"encoder_filters":{"dc_filter_alpha":0.03},"resampler":{"delay":13,"bandwidth":0.45,"attenuation":60,"filter_bank_size":64},"ofdm":{"num_subcarriers":128,"cyclic_prefix_length":16,"taper_length":8,"left_band":6,"right_band":12}},"hello-world":{"mod_scheme":"gmsk","checksum_scheme":"crc32","inner_fec_scheme":"v27","outer_fec_scheme":"none","frame_length":25,"modulation":{"center_frequency":4400,"gain":0.08},"interpolation":{"shape":"kaiser","samples_per_symbol":20,"symbol_delay":4,"excess_bandwidth":0.38},"encoder_filters":{"dc_filter_alpha":0.01},"resampler":{"delay":13,"bandwidth":0.45,"attenuation":60,"filter_bank_size":64}},"ultrasonic":{"mod_scheme":"gmsk","checksum_scheme":"crc32","inner_fec_scheme":"v27","outer_fec_scheme":"none","frame_length":34,"modulation":{"center_frequency":19000,"gain":0.02},"interpolation":{"shape":"rrcos","samples_per_symbol":14,"symbol_delay":4,"excess_bandwidth":0.35},"encoder_filters":{"dc_filter_alpha":0.01},"resampler":{"delay":13,"bandwidth":0.45,"attenuation":60,"filter_bank_size":64}},"ultrasonic-3600":{"ofdm":{"num_subcarriers":64,"cyclic_prefix_length":20,"taper_length":8,"left_band":4,"right_band":13},"mod_scheme":"V29","checksum_scheme":"crc8","inner_fec_scheme":"v27","outer_fec_scheme":"none","frame_length":550,"modulation":{"center_frequency":18500,"gain":0.01},"interpolation":{"shape":"kaiser","samples_per_symbol":7,"symbol_delay":4,"excess_bandwidth":0.33},"encoder_filters":{"dc_filter_alpha":0.01},"resampler":{"delay":13,"bandwidth":0.45,"attenuation":60,"filter_bank_size":64}},"ultrasonic-whisper":{"mod_scheme":"gmsk","checksum_scheme":"crc32","inner_fec_scheme":"v27","outer_fec_scheme":"none","frame_length":16,"modulation":{"center_frequency":19500,"gain":0.01},"interpolation":{"shape":"rrcos","samples_per_symbol":30,"symbol_delay":4,"excess_bandwidth":0.35},"encoder_filters":{"dc_filter_alpha":0.01},"resampler":{"delay":13,"bandwidth":0.45,"attenuation":60,"filter_bank_size":64}}}')),h=null;var d,m=function(){return h||(h=function(){try{throw new Error}catch(t){var e=(""+t.stack).match(/(https?|file|ftp):\/\/[^)\n]+/g);if(e)return(""+e[0]).replace(/^((?:https?|file|ftp):\/\/.+)\/[^/]+$/,"$1")+"/"}return"/"}()),h},u=n;function f(e){if(""===e)return".";var t="/"===e[e.length-1]?e.slice(0,e.length-1):e,n=t.lastIndexOf("/");return-1===n?".":t.slice(0,n)}function p(e,t){if(e===t)return"";var n=e.split("/");"."===n[0]&&n.shift();var s,r,a=t.split("/");for("."===a[0]&&a.shift(),s=0;(s<a.length||s<n.length)&&null==r;s++)n[s]!==a[s]&&(r=s);var i=[];for(s=0;s<n.length-r;s++)i.push("..");return a.length>r&&i.push.apply(i,a.slice(r)),i.join("/")}(d=function(e,t){return p(f(u(e)),u(t))})._dirname=f,d._relative=p;var b=e(m()+d("3SFso","6Z78t"));const y=new AudioContext;!async function(){const e=await async function(e,t){const n=t instanceof Promise?WebAssembly.instantiateStreaming:WebAssembly.instantiate,{instance:s}=await n(t,l);return new o(e,s)}(y,fetch(b));document.querySelector("#audible-text").addEventListener("submit",(t=>{const n=t.target.querySelector("textarea").value;var s;s=n,e.transmit({profile:_.audible,clampFrame:!1,payload:s}),t.preventDefault()}))}()}();
//# sourceMappingURL=index.5293237e.js.map
